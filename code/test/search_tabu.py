
import _setup
from nose.tools import *

import dataset
import solution
import search

database = dataset.Database.from_id(1)
tabu = search.Tabu(database, solution.Solution(database, []))

def test_one_iteration():
    tabu.search(0.00001)

    assert_equal(tabu.iterations, 1)
    assert_equal(tabu.solution.objective, 304)
    assert_equal(tabu.solution.export(), [
        (0, 0, 5, 0), (1, 1, 5, 0), (2, 2, 5, 0), (5, 0, 5, 1), (8, 4, 0, 0),
        (8, 4, 1, 0), (8, 4, 2, 0), (8, 4, 3, 0), (9, 4, 4, 0), (9, 4, 5, 0),
        (13, 0, 5, 3), (16, 2, 4, 5), (16, 3, 5, 3), (16, 4, 0, 3),
        (16, 4, 1, 3), (16, 0, 4, 5), (17, 0, 2, 5), (18, 4, 3, 4),
        (20, 0, 3, 5), (20, 4, 2, 3), (21, 0, 5, 2), (22, 2, 5, 4),
        (24, 4, 1, 4), (25, 0, 1, 5), (26, 3, 5, 0), (26, 0, 0, 5),
        (27, 0, 5, 4), (0, 0, 0, 0), (0, 0, 1, 0), (0, 0, 2, 0), (0, 0, 3, 0),
        (6, 4, 0, 1), (0, 0, 4, 0), (26, 1, 0, 0), (26, 1, 1, 0), (1, 1, 2, 0),
        (1, 1, 3, 0), (7, 1, 5, 1), (1, 1, 4, 0), (2, 2, 0, 0), (2, 2, 1, 0),
        (2, 2, 2, 0), (2, 2, 3, 0), (27, 3, 5, 4), (2, 2, 4, 0), (1, 4, 1, 1),
        (2, 3, 0, 0), (3, 4, 2, 1), (1, 3, 1, 0), (26, 4, 3, 1), (3, 3, 2, 0),
        (26, 4, 2, 4), (3, 3, 3, 0), (4, 0, 0, 1), (5, 2, 5, 1), (5, 0, 1, 1),
        (5, 0, 3, 1), (19, 1, 5, 2), (5, 0, 4, 1), (5, 1, 0, 1), (5, 1, 1, 1),
        (5, 1, 2, 1), (21, 2, 4, 2), (6, 1, 3, 1), (23, 1, 0, 5), (6, 1, 4, 1),
        (6, 2, 0, 1), (6, 2, 1, 1), (6, 2, 2, 1), (25, 3, 4, 3), (6, 2, 3, 1),
        (28, 3, 5, 1), (7, 2, 4, 1), (27, 4, 1, 2), (10, 3, 0, 1),
        (27, 4, 2, 2), (10, 3, 1, 1), (27, 4, 3, 2), (10, 3, 2, 1),
        (27, 4, 4, 2), (10, 3, 3, 1), (28, 4, 5, 1), (10, 3, 4, 0),
        (18, 0, 2, 1), (21, 4, 0, 2), (21, 4, 1, 5), (24, 1, 3, 4),
        (18, 3, 0, 4), (11, 3, 0, 3), (11, 4, 0, 4), (22, 3, 0, 5),
        (22, 0, 1, 2), (21, 0, 4, 3), (14, 0, 1, 3), (24, 0, 2, 2),
        (21, 1, 5, 4), (14, 0, 0, 3), (12, 0, 2, 3), (12, 1, 4, 3),
        (14, 2, 0, 3), (14, 3, 1, 5), (14, 1, 2, 3), (14, 1, 3, 3),
        (20, 1, 1, 5), (15, 1, 0, 3), (20, 1, 2, 5), (15, 3, 1, 4),
        (20, 1, 3, 5), (11, 0, 2, 4), (20, 1, 4, 5), (15, 0, 3, 4),
        (22, 4, 4, 1), (15, 3, 2, 4), (11, 2, 1, 3), (17, 2, 4, 3),
        (22, 1, 0, 2), (12, 0, 4, 4), (11, 2, 2, 3), (17, 1, 1, 2),
        (22, 2, 3, 4), (12, 3, 2, 5), (17, 3, 3, 4), (12, 2, 1, 4),
        (17, 1, 3, 2), (25, 2, 3, 3), (17, 1, 4, 2), (24, 1, 2, 2),
        (18, 0, 1, 4), (24, 2, 2, 4), (18, 1, 1, 4), (15, 2, 5, 3),
        (18, 1, 2, 4), (25, 1, 5, 3), (19, 0, 0, 2), (25, 3, 2, 3),
        (19, 1, 4, 4), (25, 3, 3, 3), (19, 2, 4, 4), (28, 2, 3, 5),
        (23, 2, 0, 4), (23, 2, 1, 2), (28, 2, 5, 5), (23, 2, 2, 5),
        (19, 4, 4, 4), (23, 3, 3, 5), (29, 4, 5, 2), (23, 3, 4, 4)
    ])
